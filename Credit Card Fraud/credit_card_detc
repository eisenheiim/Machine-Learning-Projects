# -*- coding: utf-8 -*-
"""Credit Card Fraud Detection.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1XeemLvZgqSNxIZQ5YZnBPcsOYuInLoSt
"""

import numpy as np
import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import accuracy_score

data=pd.read_csv("/content/creditcard.csv")

data.head()

data.Class.value_counts()
#highly imbalanced dataset

class_0=data[data.Class==0]
class_1=data[data.Class==1]

print(class_0.shape,class_1.shape)

class_0_sample=class_0.sample(n=25)

print(class_0_sample.shape,class_1.shape)

new_data=pd.concat([class_0_sample,class_1],axis=0)

new_data.head()

x=new_data.drop("Class",axis=1)
y=new_data.Class

x_train,x_test,y_train,y_test=train_test_split(x,y,test_size=0.2,stratify=y,random_state=2)

model=LogisticRegression()

model.fit(x_train,y_train)
test_res=model.predict(x_test)

print(accuracy_score(y_test,test_res))
print(accuracy_score(y_train,model.predict(x_train)))

